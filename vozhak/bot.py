import logging
import sqlite3
import asyncio
import time as t
import requests
import base64
import json
from telegram import *
from threading import Timer
import sqlite3
from telegram.error import *
from telegram.ext import *
from datetime import *
from telethon import TelegramClient
from telegram.error import TelegramError
from telegram.constants import UpdateType, ParseMode
from telethon.tl.functions.messages import GetMessagesReactionsRequest
from telethon.tl.types import InputPeerChannel, InputPeerUser

logging.basicConfig(format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
                    level=logging.INFO)
array_message = [-1002424140672,-1002369574391,-1002422931787,-1002385442088,-1002316623832,-1002328564507,-1002298382107]
logger = logging.getLogger(__name__)
bot_token =  '7404457828:AAHIo1qBuKlBvEZ5AQAi3JFe9WsB5FmNcEQ'
conn = sqlite3.connect('teams.db', check_same_thread=False)
cursor = conn.cursor()
# –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞
master_classes = {}
user_registrations = {}
players = []
waiting_game = {}
game_chats = [-1002498876619, -4564472209, -4517693420,-4581338414,-4550254545,-4505419264,-4586885712,-4597880004,-4591307105,-4541738040]
# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–≥—Ä
games = {}

# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∫–Ω–æ–ø–∫–∞–º–∏
room_messages = {}
my_id = "6033842569"
array_id=[13,50,13,15,15,8,8]
putevki='-1002373983158'
id_put = '6'
rooms_id=[]
products = [
    {
        "id": 1,
        "name": "–í–∞–¥–∏–º",
        "price": 200,
        "description": "–ê–∫—Ç–∏–≤—á–∏–∫, –±—ã–ª –≤ —ç—Ç–æ–º –ª–∞–≥–µ—Ä–µ —É–∂–µ 10 —Ä–∞–∑. –ï–≥–æ –∑–Ω–∞—é—Ç –≤—Å–µ ‚Äì –∞–¥–º–∏–Ω–∫–∞ –∏ –≤–æ–∂–∞—Ç—ã–µ. –° –Ω–∏–º –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–ª–æ –ø—Ä–æ–±–ª–µ–º, –∫–∞–∂–¥—ã–π —Ä–∞–∑ –µ–≥–æ —Å—Ç–∞–≤–∏–ª–∏ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–º –æ—Ç—Ä—è–¥–∞, –Ω–µ –¥–∞–≤–∞—è –¥—Ä—É–≥–∏–º –¥–µ—Ç—è–º –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–µ–±—è –Ω–∞ —ç—Ç–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏.",
        "image": "1.jpg"
    },
    {
        "id": 2,
        "name": "–ï–ª–∏—Å–µ–π",
        "price": 250,
        "description": "–≠—Ç–æ—Ç —Ä–µ–±—ë–Ω–æ–∫ –≤—Å–µ–≥–¥–∞ —É–ª—ã–±–∞–µ—Ç—Å—è –∏ –∑–∞—Ä—è–∂–∞–µ—Ç –≤—Å–µ—Ö –≤–æ–∫—Ä—É–≥ —Å–≤–æ–∏–º –ø–æ–∑–∏—Ç–∏–≤–æ–º. –û–Ω –ª—é–±–∏—Ç —à—É—Ç–∏—Ç—å –∏ –≤–µ—Å–µ–ª–∏—Ç—å—Å—è, –∞ –µ–≥–æ —Å–º–µ—Ö —Å–ª—ã—à–µ–Ω –¥–∞–∂–µ –Ω–∞ —Å–∞–º—ã—Ö –æ—Ç–¥–∞–ª—ë–Ω–Ω—ã—Ö —É–≥–æ–ª–∫–∞—Ö –ª–∞–≥–µ—Ä—è.",
        "image": "2.jpg"
    },
    {
        "id": 3,
        "name": "–ê–Ω–∞—Å—Ç–∞—Å–∏—è",
        "price": 150,
        "description": "–≠—Ç–æ—Ç —Ä–µ–±—ë–Ω–æ–∫ –Ω–µ –ø—Ä–∏–∑–Ω–∞—ë—Ç –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–∞–≤–∏–ª –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –û–Ω –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–µ—Ç —Ç–æ, —á—Ç–æ —Ö–æ—á–µ—Ç, –∏ –Ω–µ —Å–ª—É—à–∞–µ—Ç –Ω–∏–∫–æ–≥–æ. –ï–≥–æ —Å–≤–æ–±–æ–¥–æ–ª—é–±–∏–≤—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ —É –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π, –Ω–æ –∏–Ω–æ–≥–¥–∞ –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ—Å—Ç—è–º",
        "image": "3.jpg"
    },
    {
        "id": 4,
        "name": "–í–ª–∞–¥–∏–º–∏—Ä",
        "price": 100,
        "description": "–ï–≥–æ —Ç–∞–ª–∞–Ω—Ç –∫ —Ä–∏—Å–æ–≤–∞–Ω–∏—é –ø–æ—Ä–∞–∂–∞–µ—Ç –≤—Å–µ—Ö. –û–Ω —Å–æ–∑–¥–∞—ë—Ç —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∫—Ä–∞—à–∞—é—Ç —Å—Ç–µ–Ω—ã –ª–∞–≥–µ—Ä—è –∏ —Ä–∞–¥—É—é—Ç –≥–ª–∞–∑ –∫–∞–∂–¥–æ–≥–æ, –∫—Ç–æ –∏—Ö –≤–∏–¥–∏—Ç.",
        "image": "4.jpg"
    },
    {
        "id": 5,
        "name": "–û–∫—Å–∞–Ω–∞",
        "price": 130,
        "description": "–û–Ω–∞ –≤—Å–µ–≥–¥–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è –∏ –ª—é–±–∏—Ç –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –∫ —Å–µ–±–µ –≤–∑–≥–ª—è–¥—ã –æ–∫—Ä—É–∂–∞—é—â–∏—Ö. –ï—ë –∞–∫—Ç—ë—Ä—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –µ–π –ª–µ–≥–∫–æ –≤–∂–∏–≤–∞—Ç—å—Å—è –≤ –ª—é–±—É—é —Ä–æ–ª—å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º—ã–µ –æ–±—Ä–∞–∑—ã",
        "image": "5.jpg"
    },
    {
        "id": 6,
        "name": "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞",
        "price": 140,
        "description": "–≠—Ç–∞ –¥–µ–≤–æ—á–∫–∞ ‚Äî –Ω–∞—Å—Ç–æ—è—â–∞—è —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞. –û–Ω–∞ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤–æ –≤—Å–µ—Ö —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –ª–∞–≥–µ—Ä—è –∏ –≤—Å–µ–≥–¥–∞ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –ø–æ–±–µ–¥–µ. –ï—ë —Å–∏–ª–∞ –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –≤—ã–∑—ã–≤–∞—é—Ç –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ —É –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π.",
        "image": "6.jpg"
    },
    {
        "id": 7,
        "name": "–ú–∏—Ö–∞–∏–ª",
        "price": 180,
        "description": "–û–Ω –ø—Ä–æ–≤–æ–¥–∏—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ —á—Ç–µ–Ω–∏–µ–º –∫–Ω–∏–≥. –ï–≥–æ –∑–Ω–∞–Ω–∏—è –æ –º–∏—Ä–µ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –ø–æ—Ä–∞–∂–∞—é—Ç –¥–∞–∂–µ —Å–∞–º—ã—Ö –æ–ø—ã—Ç–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä–µ–π",
        "image": "7.jpg"
    },
    {
        "id": 8,
        "name": "–ù–∏–∫–æ–ª–∞–π",
        "price": 170,
        "description": "–£ –Ω–µ–≥–æ –µ—Å—Ç—å —Å–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω –∏–≥—Ä–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ–º. –ï–≥–æ –º—É–∑—ã–∫–∞ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –ª–∞–≥–µ—Ä—å —Ä–∞–¥–æ—Å—Ç—å—é –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º",
        "image": "8.jpg"
    },
{
        "id": 9,
        "name": "–ê—Ä—Ç–µ–º–∏–π",
        "price": 220,
        "description": "–ù–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç, –æ—Ç–∫—É–¥–∞ –æ–Ω –ø—Ä–∏—à—ë–ª –∏ —á—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç. –û–Ω –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –¥–µ—Ä–∂–∞—Ç—å—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω–µ –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–µ—Ç–µ–π –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤—Ä–µ–º—è –≤ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ",
        "image": "9.jpg"
    },
    {
        "id": 10,
        "name": "–ú–∞—Ä–∏—è",
        "price": 230,
        "description": "–û–Ω–∞ –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤–∞ –≤–∑—è—Ç—å –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø–æ–º–æ—á—å –¥—Ä—É–≥–∏–º. –ï–µ –ª–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–µ–ª–∞—é—Ç –µ–≥–æ –æ—Ç–ª–∏—á–Ω—ã–º –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–º –Ω–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥–∏—Ä–∞ –æ—Ç—Ä—è–¥–∞",
        "image": "10.jpg"
    },
    {
        "id": 11,
        "name": "–ê–Ω–≥–µ–ª–∏–Ω–∞",
        "price": 200,
        "description": "–û–Ω–∞ —á–∞—Å—Ç–æ –ø–æ–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Å–≤–æ–∏ –º—ã—Å–ª–∏ –∏ –º–µ—á—Ç—ã. –ï–µ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–π —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –º–∏—Ä—ã",
        "image": "11.jpg"
    },
    {
        "id": 12,
        "name": "–°–µ–º–µ–Ω",
        "price": 250,
        "description": "–û–Ω —É–º–µ–µ—Ç –ø–µ—Ç—å, —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å –∏ –∏–≥—Ä–∞—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö. –ï–≥–æ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è –Ω–∞ —Å—Ü–µ–Ω–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–∞—Å—Ç–æ—è—â–∏–º –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º –¥–ª—è –≤—Å–µ–≥–æ –ª–∞–≥–µ—Ä—è",
        "image": "12.jpg"
    },
    {
        "id": 13,
        "name": "–ê—Ä–∫–∞–¥–∏–π",
        "price": 150,
        "description": "–ï–º—É –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–∑—É—á–∞—Ç—å –Ω–æ–≤—ã–µ –º–µ—Å—Ç–∞ –∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –¥–ª—è —Å–µ–±—è —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ. –ï–≥–æ –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∂–∞–∂–¥–∞ –∑–Ω–∞–Ω–∏–π –¥–µ–ª–∞—é—Ç –µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º",
        "image": "13.jpg"
    },
    {
        "id": 14,
        "name": "–ò–≥–æ—Ä—å",
        "price": 100,
        "description": "–û–Ω –ª—é–±–∏—Ç —à—É—Ç–∏—Ç—å –∏ –≤–µ—Å–µ–ª–∏—Ç—å—Å—è, –Ω–æ –∏–Ω–æ–≥–¥–∞ –µ–≥–æ —à—É—Ç–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —Å–æ–≤—Å–µ–º –±–µ–∑–æ–±–∏–¥–Ω—ã–º–∏. –û–Ω –º–æ–∂–µ—Ç –ø–æ–¥—à—É—Ç–∏—Ç—å –Ω–∞–¥ –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ –≤–æ–∂–∞—Ç—ã–º–∏, –Ω–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –±–µ–∑ –∑–ª–æ–≥–æ —É–º—ã—Å–ª–∞",
        "image": "14.jpg"
    },
    {
        "id": 15,
        "name": "–ê–ª–µ–∫—Å–µ–π",
        "price": 130,
        "description": "–≠—Ç–æ—Ç —Ä–µ–±—ë–Ω–æ–∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤ –¥–≤–∏–∂–µ–Ω–∏–∏. –ï–º—É —Å–ª–æ–∂–Ω–æ —É—Å–∏–¥–µ—Ç—å –Ω–∞ –º–µ—Å—Ç–µ, –∏ –æ–Ω –≤—Å–µ–≥–¥–∞ –∏—â–µ—Ç –Ω–æ–≤—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è. –ò–Ω–æ–≥–¥–∞ –æ–Ω –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ –µ–≥–æ —ç–Ω–µ—Ä–≥–∏—è –∏ –∂–∏–∑–Ω–µ—Ä–∞–¥–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–µ–ª–∞—é—Ç –µ–≥–æ –ª—é–±–∏–º—Ü–µ–º –ª–∞–≥–µ—Ä—è",
        "image": "15.jpg"
    },
    {
        "id": 16,
        "name": "–ö—Å–µ–Ω–∏—è",
        "price": 140,
        "description": "–û–Ω –æ—á–µ–Ω—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π, –≤—Å–µ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º. –ò–Ω–æ–≥–¥–∞ –µ–≥–æ –ø–µ–¥–∞–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç —Ä–∞–∑–¥—Ä–∞–∂–∞—Ç—å –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π, –Ω–æ –æ–Ω –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å",
        "image": "16.jpg"
    },
    {
        "id": 17,
        "name": "–°–æ—Ñ–∏—è",
        "price": 180,
        "description": "–û–Ω —Ä–µ–¥–∫–æ –≥–æ–≤–æ—Ä–∏—Ç –∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤—Ä–µ–º—è –≤ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ. –ù–æ –∫–æ–≥–¥–∞ –æ–Ω –≤—Å—ë –∂–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–æ—Ç, –µ–≥–æ —Å–ª–æ–≤–∞ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –º—É–¥—Ä—ã–º–∏ –∏ –≥–ª—É–±–æ–∫–∏–º–∏. –ï–≥–æ –º–æ–ª—á–∞–ª–∏–≤–æ—Å—Ç—å —Å–æ–∑–¥–∞—ë—Ç –≤–æ–∫—Ä—É–≥ –Ω–µ–≥–æ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∑–∞–≥–∞–¥–æ—á–Ω–æ—Å—Ç–∏",
        "image": "17.jpg"
    },
    {
        "id": 18,
        "name": "–ò–≤–∞–Ω",
        "price": 170,
        "description": "–ï–º—É –Ω—Ä–∞–≤–∏—Ç—Å—è –∏—Å–ø—ã—Ç—ã–≤–∞—Ç—å —Å–µ–±—è –∏ —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –û–Ω —á–∞—Å—Ç–æ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è—Ö, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ —É –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π. –û–¥–Ω–∞–∫–æ –µ–≥–æ –±–µ–∑—Ä–∞—Å—Å—É–¥—Å—Ç–≤–æ –∏–Ω–æ–≥–¥–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ—Å—Ç—è–º",
        "image": "18.jpg"
    },
    {
        "id": 19,
        "name": "–ú–∞–∫—Å–∏–º",
        "price": 220,
        "description": "–û–Ω –≤—Å–µ–≥–¥–∞ —Å–æ–º–Ω–µ–≤–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –¥—Ä—É–≥–∏–µ. –û–Ω –ª—é–±–∏—Ç –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏ –∏—Å–∫–∞—Ç—å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–≤–µ—Ä–∏—Ç—å –≤–æ —á—Ç–æ-—Ç–æ. –ï–≥–æ —Å–∫–µ–ø—Ç–∏—Ü–∏–∑–º –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º, –Ω–æ –∏–Ω–æ–≥–¥–∞ –æ–Ω –º–µ—à–∞–µ—Ç –µ–º—É –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –∂–∏–∑–Ω—å—é",
        "image": "19.jpg"
    },
    {
        "id": 20,
        "name": "–†—É—Å–ª–∞–Ω",
        "price": 230,
        "description": "–ò–Ω–æ–≥–¥–∞ –æ–Ω –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –º–µ–ª–∫–∏–µ –ø–∞–∫–æ—Å—Ç–∏ –¥—Ä—É–≥–∏–º –¥–µ—Ç—è–º –∏–ª–∏ –≤–æ–∂–∞—Ç—ã–º. –û–Ω –Ω–µ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ–≥–æ —Å–æ –∑–ª—ã–º —É–º—ã—Å–ª–æ–º, –∞ —Å–∫–æ—Ä–µ–µ –∏–∑ –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–∞ –∏–ª–∏ –∂–µ–ª–∞–Ω–∏—è –ø–æ–≤–µ—Å–µ–ª–∏—Ç—å—Å—è. –û–¥–Ω–∞–∫–æ –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ —É –æ–∫—Ä—É–∂–∞—é—â–∏—Ö",
        "image": "20.jpg"
    },
    {
        "id": 21,
        "name": "–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
        "price": 200,
        "description": "–≠—Ç–æ—Ç —Ä–µ–±–µ–Ω–æ–∫ –ª—é–±–∏—Ç –ø—Ä—è—Ç–∞—Ç—å—Å—è –∏ –∏–≥—Ä–∞—Ç—å –≤ –ø—Ä—è—Ç–∫–∏. –ï–≥–æ –Ω–∞–≤—ã–∫–∏ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Ä–∞–∂–∞—é—Ç –¥–∞–∂–µ —Å–∞–º—ã—Ö –æ–ø—ã—Ç–Ω—ã—Ö –≤–æ–∂–∞—Ç—ã—Ö. –û–Ω –º–æ–∂–µ—Ç —Å–ø—Ä—è—Ç–∞—Ç—å—Å—è —Ç–∞–∫, —á—Ç–æ –µ–≥–æ –Ω–µ –Ω–∞–π–¥—É—Ç –¥–∞–∂–µ —Å —Å–æ–±–∞–∫–∞–º–∏",
        "image": "21.jpg"
    },
    {
        "id": 22,
        "name": "–î–∞—Ä—å—è",
        "price": 250,
        "description": "–≠—Ç–æ—Ç —Ä–µ–±—ë–Ω–æ–∫ –≤—Å–µ–≥–¥–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å–æ–Ω–Ω—ã–º –∏ —É—Å—Ç–∞–≤—à–∏–º. –û–Ω —á–∞—Å—Ç–æ –∑–∞—Å—ã–ø–∞–µ—Ç –Ω–∞ —Ö–æ–¥—É –∏ –º–æ–∂–µ—Ç –ø—Ä–æ—Å–ø–∞—Ç—å –≤—Å—ë —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ. –ù–æ –∫–æ–≥–¥–∞ –æ–Ω –±–æ–¥—Ä—Å—Ç–≤—É–µ—Ç, –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—á–µ–Ω—å –≤–µ—Å—ë–ª—ã–º –∏ –∞–∫—Ç–∏–≤–Ω—ã–º",
        "image": "22.jpg"
    },
    {
        "id": 23,
        "name": "–ï–ª–∏–∑–∞–≤–µ—Ç–∞",
        "price": 150,
        "description": "–≠—Ç–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å —Ç—ë–º–Ω–æ–π –ª–æ—à–∞–¥–∫–æ–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –æ–Ω –ø–æ–≤–µ–¥—ë—Ç —Å–µ–±—è –≤ —Å–ª–µ–¥—É—é—â–∏–π –º–æ–º–µ–Ω—Ç. –û–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–µ—Å—ë–ª—ã–º –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º, –∞ –º–æ–∂–µ—Ç –≤–Ω–µ–∑–∞–ø–Ω–æ —Å—Ç–∞—Ç—å –∑–∞–º–∫–Ω—É—Ç—ã–º –∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º. –ò–Ω–æ–≥–¥–∞ –æ–Ω –ø—Ä–æ—è–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –∫ –∫–∞–∫–∏–º-—Ç–æ –∑–∞–Ω—è—Ç–∏—è–º, –Ω–æ –±—ã—Å—Ç—Ä–æ —Ç–µ—Ä—è–µ—Ç –∫ –Ω–∏–º –∏–Ω—Ç–µ—Ä–µ—Å. –í—Å–µ –Ω–∞–¥–µ—é—Ç—Å—è, —á—Ç–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–º–æ–≥—É—Ç –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —ç—Ç–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –∏ –ø–æ–º–æ—á—å –µ–º—É —Ä–∞—Å–∫—Ä—ã—Ç—å—Å—è.",
        "image": "23.jpg"
    },
    {
        "id": 24,
        "name": "–õ–µ–≤",
        "price": 100,
        "description": "–û–Ω –≤—Å–µ–≥–¥–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è –∏ –ª—é–±–∏—Ç –±—ã—Ç—å –ª–∏–¥–µ—Ä–æ–º. –û–Ω —É–º–µ–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –≤–æ–≤–ª–µ–∫–∞—Ç—å –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π –≤ –∏–≥—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è. –û–¥–Ω–∞–∫–æ –∏–Ω–æ–≥–¥–∞ –µ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ä–∞—Å—Ç–∏ –≤ –Ω–∞–≤—è–∑—á–∏–≤–æ—Å—Ç—å",
        "image": "24.jpg"
    },
    {
        "id": 25,
        "name": "–†–æ—Å—Ç–∏—Å–ª–∞–≤",
        "price": 130,
        "description": "–û–Ω —á–∞—Å—Ç–æ –ø–æ–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Å–≤–æ–∏ –º—ã—Å–ª–∏ –∏ –º–µ—á—Ç—ã. –ï–≥–æ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–º—É —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –º–∏—Ä—ã. –ò–Ω–æ–≥–¥–∞ –æ–Ω –º–æ–∂–µ—Ç –Ω–∞—Å—Ç–æ–ª—å–∫–æ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ —Å–≤–æ–∏ —Ñ–∞–Ω—Ç–∞–∑–∏–∏, —á—Ç–æ –∑–∞–±—ã–≤–∞–µ—Ç –æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏",
        "image": "25.jpg"
    },
    {
        "id": 26,
        "name": "–ï–≤–≥–µ–Ω–∏–π",
        "price": 140,
        "description": "–ï–º—É —Å–ª–æ–∂–Ω–æ –∂–¥–∞—Ç—å –∏ —Ç–µ—Ä–ø–µ—Ç—å. –û–Ω –≤—Å–µ–≥–¥–∞ —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –≤—Å—ë –∏ —Å—Ä–∞–∑—É. –ï–≥–æ –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ —É –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π, –Ω–æ –µ–≥–æ —ç–Ω–µ—Ä–≥–∏—è –∏ —ç–Ω—Ç—É–∑–∏–∞–∑–º –¥–µ–ª–∞—é—Ç –µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º",
        "image": "26.jpg"
    },
    {
        "id": 27,
        "name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",
        "price": 180,
        "description": "–û–Ω –º–æ–∂–µ—Ç –ø–æ—á–∏–Ω–∏—Ç—å –≤—Å—ë —á—Ç–æ —É–≥–æ–¥–Ω–æ: –æ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–≥–æ —Å—Ç—É–ª–∞ –¥–æ –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞. –ï–≥–æ –Ω–∞–≤—ã–∫–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –º–µ—Ö–∞–Ω–∏–∫–∏ –¥–µ–ª–∞—é—Ç –µ–≥–æ –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º –¥–ª—è –≤–æ–∂–∞—Ç—ã—Ö –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ª–∞–≥–µ—Ä—è. –û–Ω –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –ø—Ä–∏–π—Ç–∏ –Ω–∞ –ø–æ–º–æ—â—å –∏ —Ä–µ—à–∏—Ç—å –ª—é–±—É—é –ø—Ä–æ–±–ª–µ–º—É",
        "image": "27.jpg"
    },
    {
        "id": 28,
        "name": "–°–µ–º–µ–Ω",
        "price": 170,
        "description": "–≠—Ç–æ—Ç —Ä–µ–±—ë–Ω–æ–∫ –æ–±–æ–∂–∞–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ –∏ –∏–∑—É—á–∞—Ç—å –ø—Ä–∏—Ä–æ–¥—É. –û–Ω –∑–Ω–∞–µ—Ç –≤—Å–µ —Ä–∞—Å—Ç–µ–Ω–∏—è –∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–∏—Ç–∞—é—Ç –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç—è—Ö –ª–∞–≥–µ—Ä—è, –∏ —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ –Ω–∏—Ö –¥—Ä—É–≥–∏–º –¥–µ—Ç—è–º. –ï–≥–æ –ª—é–±–æ–≤—å –∫ –ø—Ä–∏—Ä–æ–¥–µ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –æ—Ç–ª–∏—á–Ω—ã–º –∫–æ–º–ø–∞–Ω—å–æ–Ω–æ–º –¥–ª—è –ø—Ä–æ–≥—É–ª–æ–∫ –∏ –ø–æ—Ö–æ–¥–æ–≤",
        "image": "28.jpg"
    },
    {
        "id": 29,
        "name": "–Ø–Ω–∞",
        "price": 220,
        "description": "–£ —ç—Ç–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –µ—Å—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–π —Ç–∞–ª–∞–Ω—Ç –≤ –∫–∞–∫–æ–π-—Ç–æ –æ–±–ª–∞—Å—Ç–∏. –ú–æ–∂–µ—Ç –±—ã—Ç—å, —ç—Ç–æ —Ä–∏—Å–æ–≤–∞–Ω–∏–µ, –º—É–∑—ã–∫–∞, —Ç–∞–Ω—Ü—ã –∏–ª–∏ —á—Ç–æ-—Ç–æ –µ—â—ë. –ï–≥–æ —Ç–∞–ª–∞–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ —É –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π, –∏ –æ–Ω–∏ —Å —Ä–∞–¥–æ—Å—Ç—å—é –Ω–∞–±–ª—é–¥–∞—é—Ç –∑–∞ –µ–≥–æ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è–º–∏ –∏ —Ä–∞–±–æ—Ç–∞–º–∏",
        "image": "29.jpg"
    },
    {
        "id": 30,
        "name": "–ñ–∞–Ω–Ω–∞",
        "price": 230,
        "description": "–ù–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç, –æ—Ç–∫—É–¥–∞ –æ–Ω –ø—Ä–∏—à—ë–ª –∏ —á—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç. –û–Ω –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –¥–µ—Ä–∂–∞—Ç—å—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω–µ –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–µ—Ç–µ–π –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤—Ä–µ–º—è –≤ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ. –ò–Ω–æ–≥–¥–∞ –æ–Ω –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –≥—Ä—É—Å—Ç–Ω—ã–º –∏ –∑–∞–¥—É–º—á–∏–≤—ã–º, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É –Ω–µ–≥–æ –≤ –≥–æ–ª–æ–≤–µ",
        "image": "30.jpg"
    }
]
products_ids = {}
message_buy_id = ''

def check_balance(user_id, price):

    cursor.execute('SELECT team FROM users WHERE username = ?', (user_id,))
    team_id = cursor.fetchone()[0]
    cursor.execute('SELECT balance FROM team WHERE id = ?', (team_id,))
    bal = cursor.fetchone()[0]

    if price <= bal:
        cursor.execute('UPDATE team SET balance = balance - ? WHERE id = ?', (price, team_id))
        conn.commit()
        return True
    else:
        return False



async def pstart(update: Update, context: CallbackContext) -> None:
    for product in products:
        with open(f'photos/{product["image"]}', 'rb') as photo_file:
            try:
                await asyncio.sleep(5)
                keyboard = [
                    [InlineKeyboardButton(text=f"–û–ø–ª–∞—Ç–∏—Ç—å –ø—É—Ç–µ–≤–∫—É –¥–ª—è {product['name']}", callback_data=f"buy_{product['name']}")]
                ]
                reply_markup = InlineKeyboardMarkup(keyboard)
                message = await context.bot.send_photo(
                    chat_id=update.effective_chat.id,
                    photo=photo_file,
                    message_thread_id=6,
                    caption=f"–ò–º—è: {product['name']}\n–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞: {product['description']}\n–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—É—Ç–µ–≤–∫–∏: {product['price']}",
                    reply_markup=reply_markup,
                )
                products_ids[product['name']] = message.message_id
            except Exception as e:
                print(f"Error sending product photo: {e}")


mk_to_id = {}
mk_id = {}
async def check_answer(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    global master_classes
    args = context.args
    if len(args) < 2:
        await update.message.reply_text('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /mk "–∫–æ–ª-–≤–æ –ª—é–¥–µ–π" "–ù–∞–∑–≤–∞–Ω–∏–µ"')
        return

    try:
        places = int(args[0])
        name = ' '.join(args[1:])
    except ValueError:
        await update.message.reply_text('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Å—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /mk "–∫–æ–ª-–≤–æ –ª—é–¥–µ–π" "–ù–∞–∑–≤–∞–Ω–∏–µ"')
        return

    if places <= 0:
        await update.message.reply_text('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –Ω—É–ª—è.')
        return

    # Use the full name to create the master class entry
    if name == '':
        times = ["10:30", "13:40", "15:10"]
    elif name == '':
        times = ["13:40"]
    else:
        times = ["10:30", "13:40", "15:10"]
    master_classes[name] = {'places': {time: places for time in times}, 'users': {time: [] for time in times}, 'id': 0}
    reply_markup = register(name)

    message = await context.bot.send_message(chat_id="-1002373983158",
                text=f'–°–ø–∏–∫–µ—Ä: <b><i>{name}</i></b>\n–ù–∞–∑–≤–∞–Ω–∏–µ: <i>{name}</i>',parse_mode=ParseMode.HTML, message_thread_id=919, reply_markup=reply_markup)
    mk_to_id[name] = message.message_id

master_class_mapping = {
    '–ù–∞–ø–∞—Ä–Ω–∏—á–µ—Å—Ç–≤–æ: –≤–∑–≥–ª—è–¥ —Å–≤–µ—Ä—Ö—É': 'np1',
    '–ö–∞–∫ –Ω–∞—É—á–∏—Ç—å—Å—è —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∏–≤—ã—á–∫–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç –Ω–∞–º–∏': 'np2',
    '–ò—Å–ø–æ–≤–µ–¥—å —É—á–∏–ª–æ–∫ –∏–ª–∏ 10 –ø—Ä–∏—á–∏–Ω –ø–æ—á–µ–º—É —Ç—ã –ø–ª–æ—Ö–æ–π –≤–æ–∂–∞—Ç—ã–π': 'np3',
    '–ö–∞–∫ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª—é–¥–µ–π –±–µ–∑ 6 –ø–∞–ª—å—Ü–∞ –∏–ª–∏ –∫—Ä–∞—Ç–∫–∏–π —ç–∫—Å–∫—É—Ä—Å –≤ –º–∏—Ä AI': 'np4',
    '–ö–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∑–∞–¥–∞—Ç—å –≤—Å–µ–ª–µ–Ω–Ω–æ–π, —á—Ç–æ–±—ã –Ω–∞–ø–∏—Å–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É —Å–º–µ–Ω—ã? –ò –∫–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ, –µ—Å–ª–∏ –≤–¥—Ä—É–≥ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ –ø–æ –ø–ª–∞–Ω—É': 'np5',
    '–û—Ç —Å–ª–µ–∑ –∫ —É–ª—ã–±–∫–∞–º: —Å–µ–∫—Ä–µ—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã –≤ –ª–∞–≥–µ—Ä–µ': 'np6',
    '–í–æ–∂–∞—Ç—ã–π —Ç–æ–∂–µ –∞–∫—Ç—ë—Ä': 'np7',
    '–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç –ø–∞–±–ª–∏–∫–∞ ¬´–í–æ–∂–∞—Ç–Ω–∏–∫¬ª': 'np8',
    '–¢–µ–∞—Ç—Ä –¢–µ–Ω–µ–π': 'tt1',
    '–ù–µ–π—Ä–æ–≤–æ–∂–∞—Ç—ã–π': 'nv1',
    '–ó–∏–Ω—ã': 'zn1',
    '–ú–µ–¥–∏–∞ –∏ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è': 'md1',
    '–û–±—ä–µ–¥–∏–Ω—è–π –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º': 'oi1',
    '–ù–µ–Ω–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ: –æ—Ç –Ω–∞–ø–∞—Ä–Ω–∏—á–µ—Å—Ç–≤–∞ –∫ –µ–¥–∏–Ω—Å—Ç–≤—É': 'no1',
    '–ú–∫ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞—Å—Ç–æ–ª—å–Ω—ã—Ö –∏–≥—Ä': 'ng1',
    '–õ–æ–≤–∏ –ú–æ–º–µ–Ω—Ç': 'lm1',
    '–û—Ä–∞—Ç–æ—Ä—Å–∫–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ': 'oi2',
    '–í–æ–∂–∞—Ç–Ω–∏–∫': 'vg1',
    '–î–æ–∂–¥—å –º–Ω–µ –Ω–∞—à–µ–ø—Ç–∞–ª': 'dn1',
    '–°–æ–∑–¥–∞–Ω–∏–µ –≥–∏–º–Ω–∞: –æ—Ç –∏–¥–µ–∏–∏ –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏': 'sg1',
    '–Ø - –Ω–æ–≤—ã–π –ü–∏–∫–∞—Å—Å–æ': 'np9',
    '–ü—Ä–µ—Å—Å-—Ü–µ–Ω—Ç—Ä': 'pc1',
    '–í–∏–∑—É–∞–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è': 'vc1'
}


master_class_author = {
    '–ù–∞–ø–∞—Ä–Ω–∏—á–µ—Å—Ç–≤–æ: –≤–∑–≥–ª—è–¥ —Å–≤–µ—Ä—Ö—É': 'np1',
    '–ö–∞–∫ –Ω–∞—É—á–∏—Ç—å—Å—è —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∏–≤—ã—á–∫–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç –Ω–∞–º–∏': 'np2',
    '–ò—Å–ø–æ–≤–µ–¥—å —É—á–∏–ª–æ–∫ –∏–ª–∏ 10 –ø—Ä–∏—á–∏–Ω –ø–æ—á–µ–º—É —Ç—ã –ø–ª–æ—Ö–æ–π –≤–æ–∂–∞—Ç—ã–π': 'np3',
    '–ö–∞–∫ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª—é–¥–µ–π –±–µ–∑ 6 –ø–∞–ª—å—Ü–∞ –∏–ª–∏ –∫—Ä–∞—Ç–∫–∏–π —ç–∫—Å–∫—É—Ä—Å –≤ –º–∏—Ä AI': 'np4',
    '–ö–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∑–∞–¥–∞—Ç—å –≤—Å–µ–ª–µ–Ω–Ω–æ–π, —á—Ç–æ–±—ã –Ω–∞–ø–∏—Å–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É —Å–º–µ–Ω—ã? –ò –∫–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ, –µ—Å–ª–∏ –≤–¥—Ä—É–≥ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ –ø–æ –ø–ª–∞–Ω—É': 'np5',
    '–û—Ç —Å–ª–µ–∑ –∫ —É–ª—ã–±–∫–∞–º: —Å–µ–∫—Ä–µ—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã –≤ –ª–∞–≥–µ—Ä–µ': 'np6',
    '–í–æ–∂–∞—Ç—ã–π —Ç–æ–∂–µ –∞–∫—Ç—ë—Ä': 'np7',
    '–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç –ø–∞–±–ª–∏–∫–∞ ¬´–í–æ–∂–∞—Ç–Ω–∏–∫¬ª': 'np8',
}

def register(name):
    if name == '–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç –ø–∞–±–ª–∏–∫–∞ ¬´–í–æ–∂–∞—Ç–Ω–∏–∫':
        times = ["10:30", "15:10"]
    elif name == '–ù–∞–ø–∞—Ä–Ω–∏—á–µ—Å—Ç–≤–æ: –≤–∑–≥–ª—è–¥ —Å–≤–µ—Ä—Ö—É':
        times = ["13:40"]
    else:
        times = ["10:30", "13:40", "15:10"]
    keyboard = []
    for time in times:
        if master_clas[name]['places'][time] > 0:
            # Use the shorter identifier from the mapping
            short_name = master_class_mapping.get(name, name)
            callback_data = f"register_{short_name}_{time}"
            # Ensure callback_data is within the allowed length
            if len(callback_data.encode('utf-8')) > 64:
                logger.error(f"Callback data too long: {callback_data}")
                continue
            keyboard.append([InlineKeyboardButton(
                f"–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –≤ {time}\n –ú–µ—Å—Ç: {master_clas[name]['places'][time]}",
                callback_data=callback_data
            )])
    reply_markup = InlineKeyboardMarkup(keyboard)
    return reply_markup

messages_storage = {}
async def handle_messages(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    if update.message.message_thread_id == 4:
        print("yes")
        message_id = update.message.message_id
        if message_id not in messages_storage:
            messages_storage[message_id] = update.message

async def get_reactions(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    if update.message_reaction:
        print("Received a reaction")
        message_id = update.message_reaction.message_id
        user_id = update.message_reaction.user.id
        username = update.message_reaction.user.username

        old_reaction = update.message_reaction.old_reaction
        new_reaction = update.message_reaction.new_reaction

        print(f"Message ID: {message_id}, User ID: {user_id}, Username: {username}, Old Reaction: {old_reaction}, New Reaction: {new_reaction}")

        if message_id in messages_storage:
            cursor.execute('SELECT team FROM users WHERE username = ?', (username,))
            team_id = cursor.fetchone()
            if team_id is None:
                print(f"No team found for user ID: {user_id}")
                return
            team_id = team_id[0]

            if new_reaction and not old_reaction:
                cursor.execute('UPDATE team SET balance = balance + 5 WHERE id = ?', (team_id,))
                print(f"Added 5 to team {team_id}'s balance")
            elif old_reaction and not new_reaction:
                cursor.execute('UPDATE team SET balance = balance - 5 WHERE id = ?', (team_id,))
                print(f"Subtracted 5 from team {team_id}'s balance")

            conn.commit()
            chat = array_message[team_id - 1]

            cursor.execute('SELECT balance FROM team WHERE id = ?', (team_id,))
            balance = cursor.fetchone()
            if balance is None:
                print(f"No balance found for team ID: {team_id}")
                return
            balance = balance[0]
            id = array_id[team_id - 1]
            await context.bot.edit_message_text(chat_id=chat, message_id=id, text=f'–ë–∞–ª–∞–Ω—Å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã: {balance}')
async def handle_dice(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    dice = update.message.dice
    user_id = update.message.from_user.id
    username = update.message.from_user.username
    cursor.execute('SELECT team FROM users WHERE username = ?', (username,))
    team_id = cursor.fetchone()[0]
    cursor.execute('SELECT balance FROM team WHERE id = ?', (team_id,))
    current_balance = cursor.fetchone()[0]
    cursor.execute('SELECT last_reward_time FROM team WHERE id = ?', (team_id,))
    last_reward_time_str = cursor.fetchone()[0]
    last_reward_time = datetime.strptime(last_reward_time_str, '%Y-%m-%d %H:%M:%S') if last_reward_time_str else None

    if last_reward_time and datetime.now() - last_reward_time < timedelta(hours=4):
        await context.bot.send_message(chat_id=update.effective_chat.id, text='–ß–∞—Å–∏–∫–∏ –µ—â–µ –Ω–µ –¥–æ—Ç–∏–∫–∞–ª–∏')
        return

    if dice.emoji == 'üé≤':
        if dice.value == 1:
            new_balance = current_balance + 5
            if new_balance < 0: new_balance = 0
            mess = f'–í–∞–º –≤—ã–ø–∞–ª–æ —á–∏—Å–ª–æ 1! –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 5 –≤–æ–∂–∏–∫–æ–≤!'
        elif dice.value == 2:
            new_balance = current_balance + 10
            mess = f'–í–∞–º –≤—ã–ø–∞–ª–æ —á–∏—Å–ª–æ 2! –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 10 –≤–æ–∂–∏–∫–æ–≤!'
        elif dice.value == 3:
            new_balance = current_balance + 15
            mess = f'–í–∞–º –≤—ã–ø–∞–ª–æ —á–∏—Å–ª–æ 3! –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 15 –≤–æ–∂–∏–∫–æ–≤!'
        elif dice.value == 4:
            new_balance = current_balance + 20
            mess = f'–í–∞–º –≤—ã–ø–∞–ª–æ —á–∏—Å–ª–æ 4! –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 20 –≤–æ–∂–∏–∫–æ–≤!'
        elif dice.value == 5:
            new_balance = current_balance + 25
        elif dice.value == 6:
            new_balance = current_balance + 30
            mess = f'–í–∞–º –≤—ã–ø–∞–ª–æ —á–∏—Å–ª–æ 6! –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 30 –≤–æ–∂–∏–∫–æ–≤!'
        cursor.execute('UPDATE team SET balance=?,last_reward_time = ? WHERE id = ?', (new_balance, datetime.now().strftime('%Y-%m-%d %H:%M:%S'), team_id))
        conn.commit()
        chat = array_message[team_id - 1]
        await context.bot.send_message(chat_id=chat, text=mess)
        id = array_id[team_id - 1]
        await context.bot.edit_message_text(chat_id=chat, message_id=id, text=f'–ë–∞–ª–∞–Ω—Å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã: {new_balance}')

async def unban(update: Update,context)-> None:
    await context.bot.unban_chat_member(chat_id=game_chats[0], user_id=391743540)
    await context.bot.send_message(chat_id=update.effective_chat.id, text="123")

async def balance(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_id = update.message.from_user.id
    if update.effective_chat.type != 'private':
        await context.bot.delete_message(chat_id=update.effective_chat.id, message_id=update.message.message_id)
    if user_id in [391743540, 390561523, 6755435741, 6033842569]:
        args = context.args
        if len(args) != 2:
            await context.bot.send_message(chat_id=update.effective_chat.id, text='–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ: /balance "–Ω–æ–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã" "—á–∏—Å–ª–æ"')
            return

        target_team = int(args[0])
        try:
            amount = int(args[1])
        except ValueError:
            await context.bot.send_message(chat_id=update.effective_chat.id, text='–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ.')
            return

        cursor.execute('SELECT balance FROM team WHERE id = ?', (target_team,))
        existing_user = cursor.fetchone()

        if not existing_user:
            await context.bot.send_message(chat_id=update.effective_chat.id, text=f'–ö–æ–º–∞–Ω–¥–∞ –Ω–æ–º–µ—Ä {target_team} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.')
            return

        cursor.execute('UPDATE team SET balance = balance + ? WHERE id = ?', (amount, target_team))
        conn.commit()
        cursor.execute('SELECT balance FROM team WHERE id = ?', (target_team,))
        bal = cursor.fetchone()[0]
        await context.bot.send_message(chat_id=update.effective_chat.id, text=f'–ö–æ–º–∞–Ω–¥–µ –Ω–æ–º–µ—Ä {target_team} –±—ã–ª–æ –Ω–∞—á–∏—Å–ª–µ–Ω–æ {amount} –≤–æ–∂–∏–∫–æ–≤.')
        chat = array_message[target_team - 1]
        id = array_id[target_team -1]
        await context.bot.edit_message_text(chat_id=chat, message_id=id, text=f'–ë–∞–ª–∞–Ω—Å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã: {bal}')
    else:
        await context.bot.send_message(chat_id=update.effective_chat.id, text="–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ!")

master_classes_data = [
    {
        'name': '–¢–µ–∞—Ç—Ä –¢–µ–Ω–µ–π',
        'team': 'Kid.Team',
        'desc': '–ù–∞ –Ω–∞—à–µ–º –º–∫ –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∏—Å–∫—É—Å—Å—Ç–≤–æ–º —Ç–µ–∞—Ç—Ä–∞ —Ç–µ–Ω–µ–π. –ù–∞ –Ω–µ–º –≤—ã —Å–º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, —É–∑–Ω–∞—Ç—å –æ —Ç–æ–º, –Ω–∞ —Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–∑–µ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–µ–∞—Ç—Ä —Ç–µ–Ω–µ–π –≤ –ª–∞–≥–µ—Ä–µ, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ü–∏–∏ –∏ —Å–æ–±—Ä–∞—Ç—å –∏—Ö –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ!',
        'number': 6,
        'queue': 1
    },{
        'name': '–ú–µ–¥–∏–∞ –∏ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è',
        'team': '–ü–û–ü–ß',
        'desc': '–ë—É! –ò—Å–ø—É–≥–∞–ª—Å—è? –ù–µ –±–æ–π—Å—è, —ç—Ç–æ –ú–µ–¥–∏–∞ –∏ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è #–ü–û–ü–ß! –ù–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–µ –º—ã —Ä–∞—Å—Å–∫–∞–∂–µ–º –ø—Ä–æ –¥–∏–∑–∞–π–Ω –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –¥–∞–≤–Ω–æ —Ö–æ—Ç–µ–ª –Ω–∞—É—á–∏—Ç—å—Å—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ figma! –ü—Ä–æ —Ç–æ, –∫–∞–∫ nfc-–º–µ—Ç–∫–∏ –º–æ–≥—É—Ç –æ–±–æ–≥–∞—Ç–∏—Ç—å –≤–∞—à–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥–µ—Ç—å–º–∏ –∏ —Å–¥–µ–ª–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ. –ü–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—é –Ω–∞—á–Ω–µ—Ç—Å—è —Å–æ–≤—Å–µ–º —Å–∫–æ—Ä–æ!',
        'number': 15,
        'queue': 1
    },{
        'name': '–í–æ–∂–∞—Ç–Ω–∏–∫',
        'team': '–ú–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω–∏–∫',
        'desc': '–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Å—Ü–µ–Ω–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤–æ–∂–∞—Ç—ã—Ö. –†–∞—Å—Å–∫–∞–∂–µ–º —Ç–æ–Ω–∫–æ—Å—Ç–∏ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –º–∞—Å—à—Ç–∞–±–Ω—ã—Ö –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏–π –≤–æ–∂–∞—Ç—ã—Ö –Ω–∞ —Å—Ü–µ–Ω–µ. –ü—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏ —ç—Ç–æ–º –≤–æ–∑–Ω–∏–∫–∞—Ç—å.',
        'number': 15,
        'queue': 1
    },{
        'name': '–î–æ–∂–¥—å –º–Ω–µ –Ω–∞—à–µ–ø—Ç–∞–ª',
        'team': 'Big Family',
        'desc': '–ù–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–µ –≤–æ–∂–∞—Ç—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ ¬´Big family¬ª –ø–æ–¥–µ–ª–∏—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏ —Å–æ–∑–¥–∞–Ω–∏—è –≤–æ–ª—à–µ–±–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã –Ω–∞ –≤–µ—á–µ—Ä–Ω–∏—Ö —Å–±–æ—Ä–∞—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∞—Ç—Ä–∏–±—É—Ç–∏–∫–∏ –∏ –ø–æ–≥—Ä—É–∑–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ –æ–≥–æ–Ω—å–∫–∞, –≥–¥–µ –∑–≤—É–∫–∏ –ø—Ä–∏—Ä–æ–¥—ã –∏ –º–µ–ª–æ–¥–∏–∏ –≤—Å–µ–ª—è—é—Ç –≤ —Å–µ—Ä–¥—Ü–µ –æ—â—É—â–µ–Ω–∏–µ –º–∞–≥–∏–∏. –ö–∞–∂–¥—ã–π –∏–∑ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–∞—É—á–∏—Ç—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–∂–∂–µ—Ç –æ–≥–æ–Ω—å –≤ —Å–µ—Ä–¥—Ü–∞—Ö –¥–µ—Ç–µ–π –≤–æ –≤—Ä–µ–º—è –≤–µ—á–µ—Ä–Ω–µ–≥–æ —Å–±–æ—Ä–∞. –ê —Ç–∞–∫–∂–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω—Ü–µ–ø—Ü–∏—é —Å–∞—É–Ω–¥—Ö–∏–ª–∏–Ω–≥–∞ –∏ –µ–≥–æ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–Ω—è—Ç–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è. –ñ–¥–µ–º –ø–æ –æ–¥–Ω–æ–º—É —á–µ–ª–æ–≤–µ–∫—É –æ—Ç –≤–∞—à–µ–≥–æ –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—Ä—è–¥–∞!',
        'number': 10,
        'queue': 1
    },{
        'name': '–ú–∫ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞—Å—Ç–æ–ª—å–Ω—ã—Ö –∏–≥—Ä',
        'team': '–î–æ–±—Ä–æ',
        'desc': '–¢–≤–æ—Ä–∏, —á—É–≤—Å—Ç–≤—É–π –∏ –∏–≥—Ä–∞–π! ü¶Ñüé≤\n–ü–û ¬´–î–æ–±—Ä–æ¬ª –ø—Ä–∏–≥–ª–∞—à–∞–µ—Ç –≤ —Å–≤–æ—é –∏–≥—Ä–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É, —á—Ç–æ–±—ã –ø–æ–≥—Ä—É–∑–∏—Ç—å –≤–∞—Å –≤ –º–∏—Ä —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—Å—Ç–æ–ª—å–Ω—ã—Ö –∏–≥—Ä!\n–≠—Ç–∏ –∑–Ω–∞–Ω–∏—è –≤—ã —Å–º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏, –Ω–æ –∏ –Ω–∞ —Ä–∞–±–æ—Ç–µ –≤ –ª–∞–≥–µ—Ä–µ. \n–ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–º –≤–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ç–æ–Ω–∫–æ—Å—Ç—è–º–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä, –ø–æ–¥–µ–ª–∏–º—Å—è –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –º–µ—Ö–∞–Ω–∏–∫–∞–º–∏ –∏ –Ω–∞—à–∏–º–∏ –ª–∏—á–Ω—ã–º–∏ –ª–∞–π—Ñ—Ö–∞–∫–∞–º–∏. ü§´ \n–° –Ω–∞–º–∏ –≤—ã –Ω–∞—É—á–∏—Ç–µ—Å—å –¥–µ–ª–∞—Ç—å –∏–≥—Ä—ã –¥–ª—è –¥–µ—Ç–µ–π –ª—é–±–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞, –ø–æ–ø—ã—Ç–∞–µ—Ç–µ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä—è–º–æ –≤–æ –≤—Ä–µ–º—è –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–∞, –∞ –µ—â—ë —Å–º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —É–≥–æ—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –¥–ª—è –≤–∞—Å –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∏.üòãüíú\n–ë—É–¥–µ–º –∂–¥–∞—Ç—å –≤–∞—Å –Ω–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–µ!',
        'number': 10,
        'queue': 1
    },{
        'name': '–Ø - –Ω–æ–≤—ã–π –ü–∏–∫–∞—Å—Å–æ',
        'team': '–°–∏–ª–∞',
        'desc': '–í—Å–µ–º –∏–∑–≤–µ—Å—Ç–µ–Ω –ø–æ—á–µ—Ä–∫ –≤–µ–ª–∏–∫–æ–≥–æ –ü–∏–∫–∞—Å—Å–æ, –∞ –µ—Å–ª–∏ –Ω–µ—Ç - –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ! –ù–∞ –Ω–∞—à–µ–º –ú–∞—Å—Ç–µ—Ä –ö–ª–∞—Å—Å–µ –±—É–¥–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∞—Ç—å –¥–ª—è —Å–µ–±—è –∏–ª–∏ —Å–≤–æ–µ–≥–æ –±–ª–∏–∑–∫–æ–≥–æ –ø–æ—Ä—Ç—Ä–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä—É–∫–∞–º–∏! –¢–µ–±–µ –±—É–¥—É—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –±—É–∫–≤–∞–ª—å–Ω–æ —Å–æ—Ç–Ω–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º —á–∞—Å—Ç–µ–π –ª–∏—Ü–∞, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã —Å–º–æ–∂–µ—à—å —Å–æ–±—Ä–∞—Ç—å —á—Ç–æ-—Ç–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ - —Ç–æ, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ —Ç—ã –≤–∏–¥–∏—à—å —á–µ–ª–æ–≤–µ–∫–∞! –í –∫–æ–Ω–µ—á–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—É—á–∏—Ç—Å—è –±–µ–∑—É–º–Ω–æ —è—Ä–∫–∏–π –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∞–≤—Ç–æ–ø–æ—Ä—Ç—Ä–µ—Ç/–ø–æ—Ä—Ç—Ä–µ—Ç —Å–≤–æ–µ–≥–æ –¥—Ä—É–≥–∞ –∏–ª–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç —Ç–µ–±–µ –ø–æ–¥–∞—Ä–∏—Ç—å —ç–º–æ—Ü–∏–∏ –ª—é–¥—è–º –∏ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –∫–∞–∫ –≤ –º–∏—Ä –ü–∏–∫–∞—Å—Å–æ, —Ç–∞–∫ –∏ –≤ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ–± —ç—Ç–æ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏!',
        'number': 15,
        'queue': 1
    },
    {
        'name': '–ù–µ–π—Ä–æ–≤–æ–∂–∞—Ç—ã–π',
        'team': '–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞',
        'desc': '–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –¥–ª—è –≤–æ–∂–∞—Ç—ã—Ö –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤! –ù–∞—É—á–∏–º, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è –ª–∞–≥–µ—Ä–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –£—á–∞—Å—Ç–Ω–∏–∫–∏ —É–∑–Ω–∞—é—Ç, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç, —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –Ω–∞—Ö–æ–¥–∏—Ç—å –º—É–∑—ã–∫—É –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Å –ø–æ–º–æ—â—å—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –ö–∞–∂–¥—ã–π —Å–º–æ–∂–µ—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–≤–æ–∏ —Å–∏–ª—ã –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –ª–∞–≥–µ—Ä—è. –ü—Ä–∞–∫—Ç–∏–∫–∞, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Äî –≤—Å—ë —ç—Ç–æ –∂–¥–µ—Ç –≤–∞—Å –Ω–∞ –Ω–∞—à–µ–º –ú–ö!',
        'number': 20,
        'queue': 1
    },
    {
        'name': '–ó–∏–Ω—ã',
        'team': '–°–ø–∞—Ä—Ç–∞',
        'desc': '–ó–∏–Ω (–∞–Ω–≥–ª. ¬´zine¬ª) ‚Äî —ç—Ç–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –ø–µ—á–∞—Ç–Ω–æ–µ –∏–∑–¥–∞–Ω–∏–µ –∏–ª–∏ –º–∏–Ω–∏-–∂—É—Ä–Ω–∞–ª, —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –Ω–∞–ø–µ—á–∞—Ç–∞–Ω–Ω—ã–π –∞–≤—Ç–æ—Ä–æ–º –Ω–µ–±–æ–ª—å—à–∏–º —Ç–∏—Ä–∞–∂–æ–º. –ü–æ —Ñ–∞–∫—Ç—É, –º–∞–ª–∞—è —Ñ–æ—Ä–º–∞ —Å–∞–º–∏–∑–¥–∞—Ç–∞, —Å–ø–æ—Å–æ–± —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è. –ó–∏–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞, –∏–∑ –ª—é–±–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –∏ –ª—é–±–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è. –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ –∏–ª–∏ –≤—ã–ø—É—â–µ–Ω —Ü–µ–ª—ã–º —Ç–∏—Ä–∞–∂–æ–º. –°–¥–µ–ª–∞–Ω –∫–∞–∫ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, —Ç–∞–∫ –∏ –≤ —Ä—É—á–Ω—É—é (–∏–ª–∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–µ!).',
        'number': 9,
        'queue': 'X'
    },

    {
        'name': '–û–±—ä–µ–¥–∏–Ω—è–π –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º',
        'team': '–í—ã—à–∫–∞ –î–µ—Ç—è–º',
        'desc': '–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ú—ã –ø–æ–Ω–∏–º–∞–µ–º, –∫–∞–∫ –≤–∞–∂–µ–Ω –æ–±–º–µ–Ω –æ–ø—ã—Ç–æ–º, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–≥–ª–∞—à–∞–µ–º –≤–∞—Å –Ω–∞ –Ω–∞—à –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å! –ó–¥–µ—Å—å –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—Ä—è–¥–∞. –í –∏—Ç–æ–≥–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ –º—É–¥–±–æ—Ä–¥, –∞ —Ü–µ–Ω–Ω—É—é –±–∞–∑—É –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –æ–±—â–µ–Ω–∏—è. –ñ–¥–µ–º –ø–æ –æ–¥–Ω–æ–º—É —á–µ–ª–æ–≤–µ–∫—É –æ—Ç –≤–∞—à–µ–≥–æ –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—Ä—è–¥–∞!',
        'number': 10,
        'queue': 2
    },
    {
        'name': '–ù–µ–Ω–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ: –æ—Ç –Ω–∞–ø–∞—Ä–Ω–∏—á–µ—Å—Ç–≤–∞ –∫ –µ–¥–∏–Ω—Å—Ç–≤—É',
        'team': '–¢–æ–≤–∞—Ä–∏—â',
        'desc': '–ï—Å–ª–∏ —Ö–æ—Ç—å —Ä–∞–∑ –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ –ø—Ä–∏ —Å–±–ª–∏–∂–µ–Ω–∏–∏ —Å —á–µ–ª–æ–≤–µ–∫–æ–º –≤ —Ä–∞–±–æ—Ç–µ –Ω–∞ –ø—Ä–æ—Å—å–±—ã –æ—Ç–≤–µ—á–∞–ª–∏ –≥—Ä—É–±–æ—Å—Ç—å—é, –∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –Ω–µ –∑–∞–º–µ—á–∞–ª–∏ ‚Äî –∑–Ω–∞—á–∏—Ç, –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –Ω–∞—Å–∏–ª–∏–µ–º. –†–∞–∑–±–∏—Ä–∞–µ–º—Å—è, –∫–∞–∫ —É–ª—É—á—à–∏—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –Ω–∞–ø–∞—Ä–Ω–∏–∫–∞–º–∏, –æ—Ç—Ä—è–¥–æ–º –∏–ª–∏ –¥–µ—Ç—å–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥—ã –Ω–µ–Ω–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è.',
        'number': 20,
        'queue': 'X'
    },

    {
        'name': '–õ–æ–≤–∏ –ú–æ–º–µ–Ω—Ç',
        'team': '–ú–∏–ª–ª–µ–Ω–∏—É–º',
        'desc': '¬´–õ–æ–≤–∏ –º–æ–º–µ–Ω—Ç¬ª ‚Äî –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å, –≥–¥–µ –º—ã –Ω–∞—É—á–∏–º—Å—è –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å –æ–±—ã—á–Ω—ã–µ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–∞–¥—Ä—ã –≤ –ø—Ä–∏—è—Ç–Ω—ã–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è! –ë—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ –∫–∞–∫ –¥–ª—è –≤–æ–∂–∞—Ç—ã—Ö, —Ç–∞–∫ –∏ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö –±–ª–æ–≥–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç–µ–ª–∏ –±—ã —Ä–∞–∑–≤–∏—Ç—å –ª–∏—á–Ω—ã–π –±—Ä–µ–Ω–¥. –ú—ã –∂–¥—ë–º –≤—Å–µ—Ö –∂–µ–ª–∞—é—â–∏—Ö, –∫—Ç–æ —Ö–æ—Ç–µ–ª –±—ã –æ—Å–≤–æ–∏—Ç—å –∏—Å–∫—É—Å—Å—Ç–≤–æ –≤–∏–¥–µ–æ–±–ª–æ–≥–∏–Ω–≥–∞ –∏ –Ω–∞—É—á–∏—Ç—å—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç. –í—ã —Å–º–æ–∂–µ—Ç–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏ —Å–æ–∑–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∏–¥–µ–æ–∫–∞–¥—Ä—ã. –ù–µ —É–ø—É—Å—Ç–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–π–º–∞—Ç—å —Ç–æ—Ç —Å–∞–º—ã–π –º–æ–º–µ–Ω—Ç!',
        'number': 10,
        'queue': 2
    },
    {
        'name': '–û—Ä–∞—Ç–æ—Ä—Å–∫–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ',
        'team': '–í–µ—Ä—Ç–∏–∫–∞–ª—å',
        'desc': '–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –°–ü–û –í–µ—Ä—Ç–∏–∫–∞–ª—å –ø—Ä–∏–≥–ª–∞—à–∞–µ—Ç –í–∞—Å –Ω–∞ –º–∞—Å—Ç–µ—Ä –∫–ª–∞—Å—Å –ø–æ –æ—Ä–∞—Ç–æ—Ä—Å–∫–æ–º—É –∏—Å–∫—É—Å—Å—Ç–≤—É. –ù–∞ –Ω–µ–º –º—ã —Ä–∞—Å—Å–∫–∞–∂–µ–º –æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ—á–∏, –ø–æ–∫–∞–∂–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π. –¢–∞–∫ –∂–µ –≤—ã –ø–æ—É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ –¥–µ–±–∞—Ç–∞—Ö –≥–¥–µ –ø–æ–ø—Ä–æ–±—É–µ—Ç–µ —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏.',
        'number': 8,
        'queue': 'X'
    },


    {
        'name': '–°–æ–∑–¥–∞–Ω–∏–µ –≥–∏–º–Ω–∞: –æ—Ç –∏–¥–µ–∏–∏ –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏',
        'team': '–†–∞—Å—Å–≤–µ—Ç',
        'desc': '–ù–∞—É—á–∏–º—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∏–º–Ω –Ω–µ —Ç–æ–ª—å–∫–æ –∫ –æ–±—Ä–∞–∑—É –≤–æ–∂–∞—Ç–æ–≥–æ, –∞ –∫ –ª–∞–≥–µ—Ä—é –∏ –ø–µ–¥–æ—Ç—Ä—è–¥–∞! –ù–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–µ –Ω–∞–ø–∏—à–µ–º —Ç–µ–∫—Å—Ç –≥–∏–º–Ω–∞ –¥–ª—è —Ñ–µ—Å—Ç–∏–≤–∞–ª—è "–í–æ–∂–∞–∫", –ø–æ–¥–±–µ—Ä–µ–º –º—É–∑—ã–∫—É –∏ –Ω–∞–π–¥–µ–º –∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ —Å–ª–æ–≤ –∏ –º–µ–ª–æ–¥–∏–π.',
        'number': 15,
        'queue': 2
    },

    {
        'name': '–ü—Ä–µ—Å—Å-—Ü–µ–Ω—Ç—Ä',
        'team': '–ú—ë–¥',
        'desc': '"–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –≤–æ–∂–∞—Ç—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–æ –≤—Ä–µ–º—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–∞–º–æ–π –≤–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω–æ–π —Å–≤–µ—á–∫–∏, –∫–æ–≥–¥–∞ –¥—É–º–∞–µ—Ç –Ω–∞–¥ –Ω–æ–≤—ã–º –ö–¢–î –∏‚Ä¶ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∞–º—ã—Ö –∫—Ä—É—Ç—ã—Ö —Å–æ—Ü—Å–µ—Ç–µ–π —Å–≤–æ–µ–≥–æ –ø–µ–¥–æ—Ç—Ä—è–¥–∞üë®üèº‚Äçüíª\n–£–∂–µ –¥–æ–≥–∞–¥–∞–ª–∏—Å—å, –ø—Ä–æ —á—Ç–æ –±—É–¥–µ—Ç –Ω–∞—à –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å ?\n–°–∫–æ—Ä–µ–µ —Å–º–æ—Ç—Ä–∏ –∏ –≥–æ—Ç–æ–≤—å—Å—è —Ä–∞–∑–≤–∏—Ç—å –≤ —Å–µ–±–µ smm –∂–∏–ª–∫—É üëáüèªüíõ\n–ü—Ä–µ—Å—Å-—Ü–µ–Ω—Ç—Ä: –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –µ–≥–æ —Ä–∞–±–æ—Ç—ã  –≤–æ –≤—Ä–µ–º—è&–≤–Ω–µ —Å–º–µ–Ω  –∏–ª–∏ ¬´—Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ —Å—Ç–æ–∏—Ç –∑–∞ –∫—Ä–∞—Å–∏–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–æ–π?¬ª\n–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å —Ç—Ä–µ–Ω–¥–∞–º–∏ –∏ —Ç–æ, –∫–∞–∫ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤ –≤–æ–∂–∞—Ç—Å–∫—É—é –Ω–∏—à—É\n–í–∏–¥–µ–æ-—Ñ–æ—Ä–º–∞—Ç—ã: –¥–∞ –∏–ª–∏ –Ω–µ—Ç?\n¬´–ö—Ä–∞—Å–∏–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞¬ª: –∫–∞–∫, –ø–æ—á–µ–º—É –∏ –¥–ª—è —á–µ–≥–æ?"',
        'number': 25,
        'queue': 2
    },
    {
        'name': '–í–∏–∑—É–∞–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è',
        'team': 'Enjoy Camp',
        'desc': '–ú—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–º –∑—Ä–∏—Ç–µ–ª–µ–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –≤–µ—á–µ—Ä–Ω–µ–≥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Å –¥–µ—Ç—å–º–∏ –≤ —Ä–∞–º–∫–∞—Ö –ª–∞–≥–µ—Ä–Ω–æ–π —Å–º–µ–Ω—ã.\n\n–ó—Ä–∏—Ç–µ–ª–∏ –ø–æ–≥—Ä—É–∑—è—Ç—Å—è –≤ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–π –º–∏—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã, –≥–¥–µ –ø—Ä—è–º–æ –Ω–∞ –∏—Ö –≥–ª–∞–∑–∞—Ö –æ–∂–∏–≤—É—Ç –≥–µ—Ä–æ–∏ —Ä–∞—Å—Å–∫–∞–∑–∞. –ö–∞–∂–¥—ã–π —Å–º–æ–∂–µ—Ç –Ω–∞ —Å–µ–±–µ –ø—Ä–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –æ–∫—É–Ω—É—Ç—å—Å—è –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞ –≤–º–µ—Å—Ç–µ —Å —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫–æ–º. \n\n–í–∏–∑—É–∞–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è:\nüîÆ –û—Ç–∫—Ä—ã–≤–∞—é—Ç –Ω–æ–≤—ã–µ —Å–º—ã—Å–ª—ã –∏ —Ç–∞–π–Ω—ã –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π\nüé∂ –ú—É–∑—ã–∫–∞ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –Ω–æ–≤—ã–º–∏ —ç–º–æ—Ü–∏—è–º–∏ –∏ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–µ –æ—Ç—Ç–µ–Ω–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Ä–∞—Å—Å–∫–∞–∑–∞\nüé® –•—É–¥–æ–∂–Ω–∏–∫–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç —Ç–µ–∫—Å—Ç –≤ –∂–∏–≤—ã–µ –∫–∞—Ä—Ç–∏–Ω—ã\n\nüí¨ –≠—Ç–æ —à–∞–Ω—Å –≤–∑–≥–ª—è–Ω—É—Ç—å –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—É —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –æ–±—Å—É–¥–∏—Ç—å —É–≤–∏–¥–µ–Ω–Ω–æ–µ, –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏ –∏ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –∏ –∑–∞—á–µ–º —Ç–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥–µ—Ç—å–º–∏ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –≤ –ª–∞–≥–µ—Ä–Ω–æ–π —Å—Ä–µ–¥–µ.',
        'number': 20,
        'queue': 2
    }
]
master_clas = {}
async def po(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    global master_clas

    # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–æ–≤
    master_clas = {}

    for mc in master_classes_data:
        full_name = mc['name']
        team = mc['team']
        desc = mc['desc']
        queue = mc['queue']
        place = mc['number']

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è –∏–∑ –º–∞–ø–ø–∏–Ω–≥–∞
        short_name = master_class_mapping.get(full_name, None)
        if not short_name:
            logger.error(f"–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å {full_name} –Ω–µ –∏–º–µ–µ—Ç —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏.")
            continue

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º—è
        times = ["17:10"] if queue == 1 else ["18:00"]

        # –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞, —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å
        if team not in master_clas:
            master_clas[team] = {}

        # –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –≤ –∫–æ–º–∞–Ω–¥—É
        master_clas[team][short_name] = {
            'full_name': full_name,
            'places': {time: place for time in times},
            'users': {time: [] for time in times},
            'desc': desc,
        }

        # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –∑–∞–ø–∏—Å–∏
        reply_markup = create_register_keyboard(team, short_name, times)

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        message = await context.bot.send_message(
            chat_id="-1002373983158",  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à ID —á–∞—Ç–∞
            text=(
                f"----------------------------------------------------------\n"
                f"<b>–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä:</b> {team}\n\n"
                f"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b> {full_name}\n\n"
                f"<i>{desc}</i>"
            ),
            parse_mode=ParseMode.HTML,
            message_thread_id=919,  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π ID –ø–æ—Ç–æ–∫–∞
            reply_markup=reply_markup
        )
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
        mk_id[short_name] = message.message_id
        await asyncio.sleep(1)


def create_register_keyboard(team, short_name, times):
    keyboard = []
    for time in times:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –º–µ—Å—Ç
        if master_clas[team][short_name]['places'][time] > 0:
            callback_data = f"reg_{team}_{short_name}_{time}"
            if len(callback_data.encode('utf-8')) > 64:
                logger.error(f"Callback data too long: {callback_data}")
                continue
            keyboard.append([InlineKeyboardButton(
                f"–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –≤ {time}\n–ú–µ—Å—Ç: {master_clas[team][short_name]['places'][time]}",
                callback_data=callback_data
            )])
    return InlineKeyboardMarkup(keyboard)

class TicTacToe:
    def __init__(self):
        self.board = [' ' for _ in range(9)]  # 3x3 –ø–æ–ª–µ
        self.current_player = 'X'  # –ù–∞—á–∏–Ω–∞–µ—Ç X
        self.players = []  # –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
        self.player_ids = {'X': None, 'O': None}
        self.player_nicks = {'X': None, 'O': None} # –°–ª–æ–≤–∞—Ä—å, –∫–æ—Ç–æ—Ä—ã–π —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å–∏–º–≤–æ–ª —Å ID –∏–≥—Ä–æ–∫–∞

    def add_player(self, player_id,player_nick):
        if len(self.players) < 2 and player_id not in self.players:
            if len(self.players) == 0:
                self.player_ids['X'] = player_id
                self.player_nicks['X'] = player_nick# –ü–µ—Ä–≤–æ–º—É –∏–≥—Ä–æ–∫—É –¥–∞–µ–º —Å–∏–º–≤–æ–ª X
            else:
                self.player_ids['O'] = player_id
                self.player_nicks['O'] = player_nick# –í—Ç–æ—Ä–æ–º—É –∏–≥—Ä–æ–∫—É –¥–∞–µ–º —Å–∏–º–≤–æ–ª O
            self.players.append(player_id)
            return True
        return False

    def make_move(self, position):
        if self.board[position] == ' ':
            self.board[position] = self.current_player
            return True
        return False

    def switch_player(self):
        self.current_player = 'O' if self.current_player == 'X' else 'X'

    def check_winner(self):
        winning_combinations = [
            (0, 1, 2), (3, 4, 5), (6, 7, 8),  # –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ
            (0, 3, 6), (1, 4, 7), (2, 5, 8),  # –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ
            (0, 4, 8), (2, 4, 6)              # –¥–∏–∞–≥–æ–Ω–∞–ª–∏
        ]
        for a, b, c in winning_combinations:
            if self.board[a] == self.board[b] == self.board[c] != ' ':
                winner_symbol = self.board[a]
                loser_symbol = 'O' if winner_symbol == 'X' else 'X'
                return winner_symbol, loser_symbol  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∏–º–≤–æ–ª—ã –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –∏ –ø—Ä–æ–∏–≥—Ä–∞–≤—à–µ–≥–æ
        if ' ' not in self.board:
            return 'Draw', None  # –ù–∏—á—å—è, –ø—Ä–æ–∏–≥—Ä–∞–≤—à–µ–≥–æ –Ω–µ—Ç
        return None, None  # –ò–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è

    def get_board_str(self):
        return f"""
        {self.board[0]} | {self.board[1]} | {self.board[2]}
        ---------
        {self.board[3]} | {self.board[4]} | {self.board[5]}
        ---------
        {self.board[6]} | {self.board[7]} | {self.board[8]}
        """
def get_key_by_value(dictionary, value):
    for key, val in dictionary.items():
        if val == value:
            return key
    return None
async def handle_callback(update: Update, context: CallbackContext) -> None:
    query = update.callback_query
    user_id = query.from_user.id  # Get the user ID

    # Log the button data
    logger.info(f"User {user_id} clicked button with data: {query.data}")

    try:
        await query.answer()  # Acknowledge the callback query
    except BadRequest as e:
        logger.error(f"Error answering callback query: {e}")
        return

    # Split the callback data
    data = query.data.split("_")
    action, short_name, time = data[0], data[1], data[2]
    print()
    # Map the short name back to the full name


    if action == "register":
        name = get_key_by_value(master_class_mapping, short_name)
        if user_id in user_registrations:
            registered_time = user_registrations[user_id].get(name)
            if registered_time:
                try:
                    await query.answer(
                        text=f'–í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞: {name} –≤ {registered_time}',
                        show_alert=True  # Display as a pop-up alert
                    )
                except BadRequest as e:
                    logger.error(f"Error answering callback query: {e}")
                return  # Exit if the user is already registered for this time

        # Check if the user is registered for another master class at the same time
        if user_id in user_registrations:
            for mc_name, mc_time in user_registrations[user_id].items():
                if mc_time == time:
                    try:
                        await query.answer(
                            text=f'–í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞: {mc_name} –≤ {mc_time}',
                            show_alert=True  # Display as a pop-up alert
                        )
                    except BadRequest as e:
                        logger.error(f"Error answering callback query: {e}")
                    return  # Exit if the user is already registered for this time

        if name in master_classes:
            master_classes[name]['users'][time].append(user_id)
            if name not in user_registrations:
                user_registrations[user_id] = {}
            user_registrations[user_id][name] = time
            master_classes[name]['places'][time] -= 1
            reply_markup = register(name)
            await query.edit_message_text(
                text=f'–°–ø–∏–∫–µ—Ä: <b><i>{name}</i></b>\n–ù–∞–∑–≤–∞–Ω–∏–µ: <i>{name}</i>',
                parse_mode=ParseMode.HTML,
                reply_markup=reply_markup
            )
            try:
                await context.bot.send_message(
                    chat_id=6033842569,
                    text=f'@{query.from_user.username} –Ω–∞: {name} –≤ {time}',
                )
            except BadRequest as e:
                logger.error(f"Error answering callback query: {e}")
            await context.bot.send_message(chat_id=6033842569, text=f'@{query.from_user.username} {name} –≤ {time}')


    elif action == "reg":
        data = query.data.split("_")
        if len(data) != 4 or data[0] != "reg":
            logger.error(f"Invalid callback data: {query.data}")
            return

        team, short_name, time = data[1], data[2], data[3]
        user_id = query.from_user.id
        username = query.from_user.username

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if team not in master_clas or short_name not in master_clas[team]:
            logger.error(f"Invalid team or short_name in callback: {query.data}")
            await query.answer("–û—à–∏–±–∫–∞! –ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω.")
            return

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø–∏—Å–∞–ª—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–Ω–µ–µ
        for t in master_clas:
            for short, mc_data in master_clas[t].items():
                for t_slot, users in mc_data['users'].items():
                    if user_id in users:
                        await query.answer(
                            "–í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å!",
                            show_alert=True
                        )
                        return

        mc = master_clas[team][short_name]

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –º–µ—Å—Ç
        if mc['places'][time] <= 0:
            await query.answer("–ú–µ—Å—Ç –±–æ–ª—å—à–µ –Ω–µ—Ç!", show_alert=True)
            return

        # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        mc['places'][time] -= 1
        mc['users'][time].append(user_id)

        # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–µ—Å—Ç
        reply_markup = create_register_keyboard(team, short_name, mc['places'].keys())
        try:
            await query.edit_message_text(
                text=(
                    f"----------------------------------------------------------\n"
                    f"<b>–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä:</b> {team}\n\n"
                    f"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b> {mc['full_name']}\n\n"
                    f"<i>{mc['desc']}</i>"
                ),
                parse_mode=ParseMode.HTML,
                reply_markup=reply_markup
            )
        except BadRequest as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
        try:
            await context.bot.send_message(
                chat_id=6033842569,
                text=f"@{username} –∑–∞–ø–∏—Å–∞–ª—Å—è –Ω–∞ {mc['full_name']} –≤ {time}."
            )
        except BadRequest as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É: {e}")

    elif action == "join":
        chat_id = int(short_name)
        game = games.get(chat_id)

        if game is None:
            games[chat_id] = TicTacToe()
            game = games[chat_id]

        if game.add_player(user_id):
            if len(game.players) == 2:
                await context.bot.send_message(
                    chat_id=chat_id,
                    text=f"–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –•–æ–¥–∏—Ç X:\n{game.get_board_str()}",
                    reply_markup=create_keyboard()
                )
            else:
                # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –Ω–∞ 2 –º–∏–Ω—É—Ç—ã
                context.job_queue.run_once(kick_user, 120, data={'chat_id': chat_id, 'user_id': user_id})
                await update.callback_query.answer("–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∏–≥—Ä–µ. –û–∂–∏–¥–∞–µ–º –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞...")
        else:
            await update.callback_query.answer("–ò–≥—Ä–∞ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –∏–ª–∏ –≤—ã —É–∂–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ.")


    elif action.isdigit():

        position = int(action)

        chat_id = update.callback_query.message.chat.id

        game = games.get(chat_id)

        if game is None:
            await update.callback_query.answer("–ò–≥—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")

            return

        if user_id != game.players[0] and user_id != game.players[1]:
            await update.callback_query.answer("–í—ã –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —ç—Ç–æ–π –∏–≥—Ä–µ.")

            return

        if user_id != game.player_ids[game.current_player]:
            await update.callback_query.answer(f"–•–æ–¥–∏—Ç –∏–≥—Ä–æ–∫ {game.player_ids[game.current_player]}.")

            return

        if not game.make_move(position):
            await update.callback_query.answer("–≠—Ç–∞ –∫–ª–µ—Ç–∫–∞ —É–∂–µ –∑–∞–Ω—è—Ç–∞!")

            return

        winner_symbol, loser_symbol = game.check_winner()

        if winner_symbol:
            if winner_symbol == 'Draw':
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∏—á—å–µ–π –≤ –¥—Ä—É–≥–æ–π —á–∞—Ç
                await context.bot.send_message(
                    chat_id=putevki,  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ ID —Ü–µ–ª–µ–≤–æ–≥–æ —á–∞—Ç–∞
                    text=f"–ò–≥—Ä–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –Ω–∏—á—å–µ–π!\n{game.get_board_str()}",
                    message_thread_id=54
                )
                await update.callback_query.edit_message_text(
                    text=f"–ò–≥—Ä–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –Ω–∏—á—å–µ–π!\n{game.get_board_str()}"
                )
            else:
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ –≤ –¥—Ä—É–≥–æ–π —á–∞—Ç
                await context.bot.send_message(
                    chat_id=putevki,  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ ID —Ü–µ–ª–µ–≤–æ–≥–æ —á–∞—Ç–∞
                    text=f"–ò–≥—Ä–æ–∫ {game.player_ids[winner_symbol]} –ø–æ–±–µ–¥–∏–ª!\n{game.get_board_str()}",
                    message_thread_id=54
                )
                await update.callback_query.edit_message_text(
                    text=f"–ò–≥—Ä–æ–∫ {game.player_ids[winner_symbol]} –ø–æ–±–µ–¥–∏–ª!\n{game.get_board_str()}"
                )

                # –õ–æ–≥–∏–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∫–æ–º–∞–Ω–¥

                cursor.execute('SELECT team FROM users WHERE id = ?', (game.player_nicks[winner_symbol],))

                team_win = cursor.fetchone()

                cursor.execute('SELECT team FROM users WHERE id = ?', (game.player_nicks[loser_symbol],))

                team_lose = cursor.fetchone()

                if team_win and team_lose:
                    # –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∫–æ–º–∞–Ω–¥

                    cursor.execute('UPDATE team SET balance = balance + 5 WHERE id = ?', (team_win[0],))

                    conn.commit()

                    cursor.execute('SELECT balance FROM team WHERE id = ?', (team_win[0],))

                    bal = cursor.fetchone()

                    chat = array_message[team_win[0] - 1]  # –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º –ø–æ –∫–æ–º–∞–Ω–¥–µ

                    id = array_id[team_win[0] - 1]

                    await context.bot.edit_message_text(chat_id=chat, message_id=id,
                                                        text=f'–ë–∞–ª–∞–Ω—Å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã: {bal[0]}')

                    cursor.execute('UPDATE team SET balance = balance - 5 WHERE id = ?', (team_lose[0],))

                    conn.commit()

                    cursor.execute('SELECT balance FROM team WHERE id = ?', (team_lose[0],))

                    bal = cursor.fetchone()

                    chat = array_message[team_lose[0] - 1]  # –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º –ø–æ –∫–æ–º–∞–Ω–¥–µ

                    id = array_id[team_lose[0] - 1]

                    await context.bot.edit_message_text(chat_id=chat, message_id=id,
                                                        text=f'–ë–∞–ª–∞–Ω—Å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã: {bal[0]}')

            invite = await context.bot.create_chat_invite_link(chat_id=chat_id)

            keyboard = [

                [InlineKeyboardButton(f"–ö–æ–º–Ω–∞—Ç–∞", url=invite.invite_link)]

            ]

            reply_markup = InlineKeyboardMarkup(keyboard)

            await context.bot.edit_message_reply_markup(chat_id=putevki, message_id=room_messages[chat_id],

                                                        reply_markup=reply_markup)

            del games[chat_id]  # –£–¥–∞–ª—è–µ–º –∏–≥—Ä—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

        else:

            game.switch_player()  # –ú–µ–Ω—è–µ–º –∏–≥—Ä–æ–∫–∞

            await update.callback_query.edit_message_text(

                text=f"–•–æ–¥–∏—Ç {game.current_player}:\n{game.get_board_str()}",

                reply_markup=create_keyboard()  # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–ª—è

            )


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    if all(chat_id in games for chat_id in game_chats):
        await update.message.reply_text("–í—Å–µ —á–∞—Ç—ã –∑–∞–Ω—è—Ç—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.")
        return

    # –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –∏–≥—Ä–æ–≤—ã–µ —á–∞—Ç—ã
    for i, game_chat in enumerate(game_chats):
        invite = await context.bot.create_chat_invite_link(chat_id=game_chat)
        keyboard = [
            [InlineKeyboardButton(f"–ö–æ–º–Ω–∞—Ç–∞ {i+1}",url= invite.invite_link)]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        message = await context.bot.send_message(
            chat_id=update.effective_chat.id,
            text=f"–ö–æ–º–Ω–∞—Ç–∞ {i+1}",
            reply_markup=reply_markup,
            message_thread_id=54
        )
        await asyncio.sleep(1)

        print(game_chat,message.message_id)
        room_messages[game_chat] = message.message_id

async def player_move(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    chat_id = update.callback_query.message.chat.id
    user_id = update.callback_query.from_user.id
    game = games.get(chat_id)

    if game is None:
        await update.callback_query.answer("–ò–≥—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
        return

    if user_id != game.players[0] and user_id != game.players[1]:
        await update.callback_query.answer("–í—ã –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —ç—Ç–æ–π –∏–≥—Ä–µ.")
        return

    if user_id != game.player_ids[game.current_player]:
        await update.callback_query.answer(f"–•–æ–¥–∏—Ç –∏–≥—Ä–æ–∫ {game.player_ids[game.current_player]}.")
        return

    position = int(update.callback_query.data)

    if not game.make_move(position):
        await update.callback_query.answer("–≠—Ç–∞ –∫–ª–µ—Ç–∫–∞ —É–∂–µ –∑–∞–Ω—è—Ç–∞!")
        return

    winner_symbol, loser_symbol = game.check_winner()
    if winner_symbol:
        if winner_symbol == 'Draw':
            await update.callback_query.edit_message_text(
                text=f"–ò–≥—Ä–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –Ω–∏—á—å–µ–π!\n{game.get_board_str()}"
            )
        else:
            await update.callback_query.edit_message_text(
                text=f"–ò–≥—Ä–æ–∫ {game.player_ids[winner_symbol]} –ø–æ–±–µ–¥–∏–ª!\n{game.get_board_str()}"
            )

        # –õ–æ–≥–∏–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∫–æ–º–∞–Ω–¥
        cursor.execute('SELECT team FROM users WHERE id = ?', (game.player_nicks[winner_symbol],))
        team_win = cursor.fetchone()
        cursor.execute('SELECT team FROM users WHERE id = ?', (game.player_nicks[loser_symbol],))
        team_lose = cursor.fetchone()

        if team_win and team_lose:
            # –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∫–æ–º–∞–Ω–¥
            cursor.execute('UPDATE team SET balance = balance + 5 WHERE id = ?', (team_win[0],))
            conn.commit()

            cursor.execute('SELECT balance FROM team WHERE id = ?', (team_win[0],))
            bal = cursor.fetchone()
            chat = array_message[team_win[0] - 1]  # –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º –ø–æ –∫–æ–º–∞–Ω–¥–µ
            id = array_id[team_win[0] - 1]
            await context.bot.edit_message_text(chat_id=chat, message_id=id, text=f'–ë–∞–ª–∞–Ω—Å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã: {bal[0]}')

            cursor.execute('UPDATE team SET balance = balance - 5 WHERE id = ?', (team_lose[0],))
            conn.commit()

            cursor.execute('SELECT balance FROM team WHERE id = ?', (team_lose[0],))
            bal = cursor.fetchone()
            chat = array_message[team_lose[0] - 1]  # –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º –ø–æ –∫–æ–º–∞–Ω–¥–µ
            id = array_id[team_lose[0] - 1]
            await context.job_queue.run_once(kick_user,1,data={'chat_id': chat_id, 'user_id': game.player_ids[loser_symbol]})
            await context.job_queue.run_once(kick_user,1,data={'chat_id': chat_id, 'user_id': game.player_ids[winner_symbol]})
            await context.bot.edit_message_text(chat_id=chat, message_id=id, text=f'–ë–∞–ª–∞–Ω—Å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã: {bal[0]}')
        for player_id in game.players:
            await context.bot.kick_chat_member(chat_id=chat_id, user_id=player_id)
        await context.bot.send_message(chat_id=chat_id, text="–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∫–∏–∫–Ω—É–ª–∏ –∏–∑ —á–∞—Ç–∞.")
        del games[chat_id]  # –£–¥–∞–ª—è–µ–º –∏–≥—Ä—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    else:
        game.switch_player()  # –ú–µ–Ω—è–µ–º –∏–≥—Ä–æ–∫–∞
        await update.callback_query.edit_message_text(
            text=f"–•–æ–¥–∏—Ç {game.current_player}:\n{game.get_board_str()}",
            reply_markup=create_keyboard()  # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–ª—è
        )

def create_keyboard():
    keyboard = [
        [InlineKeyboardButton("1", callback_data='0'), InlineKeyboardButton("2", callback_data='1'), InlineKeyboardButton("3", callback_data='2')],
        [InlineKeyboardButton("4", callback_data='3'), InlineKeyboardButton("5", callback_data='4'), InlineKeyboardButton("6", callback_data='5')],
        [InlineKeyboardButton("7", callback_data='6'), InlineKeyboardButton("8", callback_data='7'), InlineKeyboardButton("9", callback_data='8')]
    ]
    return InlineKeyboardMarkup(keyboard)

job_queue = JobQueue()

async def handle_new_chat_members(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    chat_id = update.message.chat.id
    if chat_id in game_chats:
        new_members = update.message.new_chat_members
        if chat_id in game_chats:
            game = games.get(chat_id)
            if game is None:
                games[chat_id] = TicTacToe()
                game = games[chat_id]

            for member in new_members:
                user_id = member.id
                if game.add_player(user_id):
                    if len(game.players) == 2:
                        await context.bot.send_message(
                            chat_id=chat_id,
                            text=f"–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –•–æ–¥–∏—Ç X:\n{game.get_board_str()}",
                            reply_markup=create_keyboard()
                        )
                        await context.bot.edit_message_reply_markup(chat_id=putevki, message_id=room_messages[chat_id],
                                                                    reply_markup=None)
                    else:
                        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –Ω–∞ 2 –º–∏–Ω—É—Ç—ã
                        context.job_queue.run_once(kick_user, 120, data={'chat_id': chat_id, 'user_id': user_id})
                        await context.bot.send_message(
                            chat_id=chat_id,
                            text=f"–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∏–≥—Ä–µ. –û–∂–∏–¥–∞–µ–º –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞..."
                        )
                else:
                    await context.bot.send_message(
                        chat_id=chat_id,
                        text="–ò–≥—Ä–∞ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –∏–ª–∏ –≤—ã —É–∂–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ."
                    )

async def kick_user(context):
    data = context.job.data
    chat_id = data['chat_id']
    user_id = data['user_id']
    bot: Bot = context.bot
    await bot.ban_chat_member(chat_id, user_id)
    await bot.unban_chat_member(chat_id, user_id)
    del games[chat_id]

async def handle_message(update: Update, context: CallbackContext) -> None:
    text = update.message.text
    tasks = text.split('\n')[1:]

    for i, task in enumerate(tasks):
        if i < len(tasks):
            keyboard = [
                [InlineKeyboardButton("–ü–µ—Ä–µ–π—Ç–∏ –≤ —á–∞—Ç", url=f"https://t.me/mary_vii")]
            ]
            reply_markup = InlineKeyboardMarkup(keyboard)
            await context.bot.send_message(chat_id=putevki,text=task, reply_markup=reply_markup,message_thread_id=57)
            await asyncio.sleep(1)

def xd(update: Update, context: CallbackContext) -> None:
    update.message.reply_text('–ü—Ä–∏–≤–µ—Ç! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏ —è –ø–µ—Ä–µ—à–ª—é –µ–≥–æ –≤ –¥—Ä—É–≥–æ–π —á–∞—Ç.')

async def forward_message(update: Update, context: CallbackContext) -> None:
    video_note = update.message.video_note

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤–∏–¥–µ–æ—Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –¥—Ä—É–≥–æ–π —á–∞—Ç –∫–∞–∫ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await context.bot.send_video_note(chat_id=putevki,message_thread_id=919, video_note=video_note.file_id)


def main():
    application = ApplicationBuilder().token(bot_token).build()

    application.add_handler(MessageReactionHandler(get_reactions))
    application.add_handler(CommandHandler('help', unban))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_messages))
    application.add_handler(CommandHandler('tasks',handle_message))
    application.add_handler(CommandHandler("game", start))
    application.add_handler(CallbackQueryHandler(handle_callback))
    application.add_handler(MessageHandler(filters.VIDEO_NOTE, forward_message))
    application.add_handler(MessageHandler(filters.Dice.ALL, handle_dice))
    application.add_handler(CommandHandler("product", pstart))
    application.add_handler(CommandHandler("po",po))
    application.add_handler(MessageHandler(filters.StatusUpdate.NEW_CHAT_MEMBERS, handle_new_chat_members))
    application.add_handler(CommandHandler("mk", check_answer))
    application.add_handler(CommandHandler("balance", balance))

    application.run_polling()

if __name__ == '__main__':
    main()
